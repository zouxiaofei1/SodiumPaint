<Window x:Class="TabPaint.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TabPaint"
        xmlns:controls="clr-namespace:TabPaint.Controls"
     
        Title="TabPaint 设置" Height="500" Width="700"
        ResizeMode="NoResize" WindowStartupLocation="CenterOwner"
        Background="{DynamicResource ChromeLowBrush}"
        Foreground="{DynamicResource TextPrimaryBrush}">
    <!-- Background 和 Foreground 均已绑定资源 -->

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/Resources/SubWindowStyles.xaml"/>
                <!-- 确保 App.xaml 中已经合并了 LightTheme.xaml，否则这里可能需要单独引用，
                     但通常由App全局管理，这里只需引用 SubWindowStyles -->
            </ResourceDictionary.MergedDictionaries>
            <local:NonLinearConverter x:Key="NonLinearConverter"/>
            <local:ColorMatchConverter x:Key="ColorMatchConverter"/>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="180"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="60"/>
        </Grid.RowDefinitions>

        <!-- 左侧导航 -->
        <!-- Background: #F0F0F0 -> ChromeMediumBrush -->
        <!-- BorderBrush: #E5E5E5 -> BorderBrush (稍微深一点点，但在深色模式下可见性更好) -->
        <Border Grid.Row="0" Grid.Column="0" 
                Background="{DynamicResource ChromeMediumBrush}" 
                BorderBrush="{DynamicResource BorderBrush}" 
                BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <ListBox x:Name="NavListBox" 
                         Grid.Row="0"
                         SelectionChanged="NavListBox_SelectionChanged" 
                         Background="Transparent" 
                         BorderThickness="0"
                         Margin="0,10,0,0"
                         ItemContainerStyle="{StaticResource NavListBoxItemStyle}">
                    <ListBoxItem Tag="General" IsSelected="True">通用</ListBoxItem>
                    <ListBoxItem Tag="Paint">画图设置</ListBoxItem>
                    <ListBoxItem Tag="View">看图设置</ListBoxItem>
                    <ListBoxItem Tag="Shortcuts">快捷键设置</ListBoxItem>
                    <ListBoxItem Tag="Advanced">高级</ListBoxItem>
                </ListBox>
                <ListBox x:Name="BottomListBox" 
                         Grid.Row="1"
                         SelectionChanged="NavListBox_SelectionChanged"
                         Background="Transparent" 
                         BorderThickness="0" 
                         Margin="0,0,0,10"
                         ItemContainerStyle="{StaticResource NavListBoxItemStyle}">
                    <ListBoxItem Tag="About">关于</ListBoxItem>
                </ListBox>
            </Grid>
        </Border>

        <!-- 右侧内容区 -->
        <!-- Background: White -> WindowBackgroundBrush -->
        <Border Grid.Row="0" Grid.Column="1" Background="{DynamicResource WindowBackgroundBrush}">

            <ScrollViewer Style="{StaticResource FluentScrollViewer}" Padding="0" Margin="0" 
                          VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" PanningMode="None">
                <Grid>
                    <!-- 1. 通用 -->
                    <StackPanel x:Name="GeneralPanel" Visibility="Visible" Margin="24">
                        <TextBlock Text="通用" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <TextBlock Text="启动" FontWeight="SemiBold" FontSize="16" Margin="0,5,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="自动加载同文件夹图片"/>
                                <!-- Foreground: Gray -> TextTertiaryBrush -->
                                <TextBlock Text="打开单张图片时，自动扫描并加载同级目录下的其他图片" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
                                      IsChecked="{Binding Path=Current.AutoLoadFolderImages, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      VerticalAlignment="Center"/>
                        </Grid>
                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="默认进入看图模式"/>
                                <TextBlock Text="程序启动时自动隐藏工具栏，适合作为默认看图软件使用" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
                                      IsChecked="{Binding Path=Current.StartInViewMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      VerticalAlignment="Center"/>
                        </Grid>

                        <!-- 分隔线 Background: #EEEEEE -> BorderLightBrush -->
                        <Separator Margin="0,10,0,10" Background="{DynamicResource BorderLightBrush}"/>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="鼠标滚轮操作"/>
                                <TextBlock Text="滑动鼠标滚轮时程序的响应" Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource FluentComboBoxStyle}"
                                      SelectedValue="{Binding Path=Current.ResamplingMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      SelectedValuePath="Tag"
                                      Height="30" VerticalContentAlignment="Center">
                                <ComboBoxItem Content="自动" Tag="Auto"/>
                                <ComboBoxItem Content="上下滚动图片" Tag="Up"/>
                                <ComboBoxItem Content="切换图片" Tag="Switch"/>
                            </ComboBox>
                        </Grid>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="外观主题"/>
                                <TextBlock Text="切换明亮或黑暗模式" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource FluentComboBoxStyle}"
                                      SelectedValue="{Binding Path=Current.ThemeMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      SelectedValuePath="Tag"
                                      Height="30" VerticalContentAlignment="Center">
                                <ComboBoxItem Content="跟随系统" Tag="System"/>
                                <ComboBoxItem Content="浅色 (Light)" Tag="Light"/>
                                <ComboBoxItem Content="深色 (Dark)" Tag="Dark"/>
                            </ComboBox>
                        </Grid>
                        <Grid Margin="0,15,0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel VerticalAlignment="Top">
                                <TextBlock Text="主题色"/>
                                <TextBlock Text="界面强调颜色与工具图标颜色" 
                   Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <!-- 颜色选择区域 -->
                            <ItemsControl Grid.Column="1">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.Resources>
                                    <!-- 定义颜色块样式 -->
                                    <Style TargetType="RadioButton" x:Key="ColorRadioStyle">
                                        <Setter Property="Width" Value="32"/>
                                        <Setter Property="Height" Value="32"/>
                                        <Setter Property="Margin" Value="0,0,10,5"/>
                                        <Setter Property="Cursor" Value="Hand"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="RadioButton">
                                                    <Grid>
                                                        <!-- 选中时的外圈 -->
                                                        <Border x:Name="SelectionBorder" 
                                        CornerRadius="16" 
                                        BorderThickness="2" 
                                        BorderBrush="{Binding Background, RelativeSource={RelativeSource TemplatedParent}}"
                                        Opacity="0"
                                        Width="32" Height="32"/>
                                                        <!-- 颜色主体 -->
                                                        <Border Width="22" Height="22" CornerRadius="11" 
                                        Background="{Binding Background, RelativeSource={RelativeSource TemplatedParent}}"
                                        HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        <!-- 选中时的勾 -->
                                                        <Path x:Name="CheckMark" Data="M2,6 L5,9 L10,3" Stroke="White" StrokeThickness="2" 
                                      HorizontalAlignment="Center" VerticalAlignment="Center"
                                      Visibility="Collapsed"/>
                                                    </Grid>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter TargetName="SelectionBorder" Property="Opacity" Value="1"/>
                                                            <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ItemsControl.Resources>
                             
                     
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#0078D4" 
                     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#0078D4}"
                     Command="{Binding SetColorCommand}" CommandParameter="#0078D4"/>
                    
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#9333EA"
                     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance},  Converter={StaticResource ColorMatchConverter}, ConverterParameter=#9333EA}"
                     Command="{Binding SetColorCommand}" CommandParameter="#9333EA"/>
                      
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#107C10"
                     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance},  Converter={StaticResource ColorMatchConverter}, ConverterParameter=#107C10}"
                     Command="{Binding SetColorCommand}" CommandParameter="#107C10"/>
                      
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#D13438"
                     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#D13438}"
                     Command="{Binding SetColorCommand}" CommandParameter="#D13438"/>
                        
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#E3008C"
                     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#E3008C}"
                     Command="{Binding SetColorCommand}" CommandParameter="#E3008C"/>
             
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#505050"
                     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#505050}"
                     Command="{Binding SetColorCommand}" CommandParameter="#505050"/>
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#FF8C00"
     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#FF8C00}"
     Command="{Binding SetColorCommand}" CommandParameter="#FF8C00"/>

                                <!-- 2. 青色 (Teal/Cyan) - 清新、科技感强，类似 Windows 默认风格之一 -->
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#00B294"
     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#00B294}"
     Command="{Binding SetColorCommand}" CommandParameter="#00B294"/>

                                <!-- 3. 靛青色 (Indigo/Blue Violet) - 沉稳、专业，比现有紫色更偏蓝 -->
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#4F46E5"
     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#4F46E5}"
     Command="{Binding SetColorCommand}" CommandParameter="#4F46E5"/>

                                <!-- 4. 金黄色 (Gold/Amber) - 高亮、醒目，用于强调特定重要性 -->
                                <RadioButton Style="{StaticResource ColorRadioStyle}" Background="#FFB900"
     IsChecked="{Binding Path=Current.ThemeAccentColor, Source={x:Static local:SettingsManager.Instance}, Converter={StaticResource ColorMatchConverter}, ConverterParameter=#FFB900}"
     Command="{Binding SetColorCommand}" CommandParameter="#FFB900"/>

                            </ItemsControl>
                        </Grid>

                    </StackPanel>

                    <!-- 2. 画图设置 -->
                    <StackPanel x:Name="PaintPanel" Visibility="Collapsed" Margin="24">
                        <TextBlock Text="画图设置" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock Text="编辑习惯" FontWeight="SemiBold" FontSize="16" Margin="0,5,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="剪贴板图片自动弹出"/>
                                <TextBlock Text="当后台监听检测到剪贴板有新图片时，自动激活并置顶窗口" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
                                      IsChecked="{Binding Path=Current.AutoPopupOnClipboardImage, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      VerticalAlignment="Center"/>
                        </Grid>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="选区删除背景"/>
                                <TextBlock Text="使用Delete键或剪切选区时的填充方式" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource FluentComboBoxStyle}"
                                      SelectedValue="{Binding Path=Current.SelectionClearMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      SelectedValuePath="Tag"
                                      Height="30" VerticalContentAlignment="Center">
                                <ComboBoxItem Content="透明 (Transparent)" Tag="Transparent"/>
                                <ComboBoxItem Content="纯白 (White)" Tag="White"/>
                                <ComboBoxItem Content="仅填充颜色 (保留Alpha)" Tag="PreserveAlpha"/>
                            </ComboBox>
                        </Grid>
                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="允许 Delete 键删除文件"/>
                                <TextBlock Text="无选区时，允许通过单击 Delete 键删除当前文件" 
                   Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
              IsChecked="{Binding Path=Current.EnableFileDeleteInPaintMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
              VerticalAlignment="Center"/>
                        </Grid>
                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>
                    </StackPanel>

                    <!-- 3. 看图设置 -->
                    <StackPanel x:Name="ViewPanel" Visibility="Collapsed" Margin="24">
                        <TextBlock Text="看图设置" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock Text="交互习惯" FontWeight="SemiBold" FontSize="16" Margin="0,5,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="鼠标滚轮功能"/>
                                <TextBlock Text="看图模式下，直接滚动滚轮时的操作" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource FluentComboBoxStyle}"
                                      SelectedValue="{Binding Path=Current.ViewMouseWheelMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      SelectedValuePath="Tag"
                                      Height="30" VerticalContentAlignment="Center">
                                <ComboBoxItem Content="缩放图片 (Zoom)" Tag="Zoom"/>
                                <ComboBoxItem Content="切换图片 (Prev/Next)" Tag="SwitchImage"/>
                            </ComboBox>
                        </Grid>

                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>
                        <TextBlock Text="显示" FontWeight="SemiBold" FontSize="16" Margin="0,5,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="使用深色背景"/>
                                <TextBlock Text="在图片周围显示深灰色背景" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
                                      IsChecked="{Binding Path=Current.ViewUseDarkCanvasBackground, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      VerticalAlignment="Center"/>
                        </Grid>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="显示透明度网格"/>
                                <TextBlock Text="开启后透明区域显示灰白格子，关闭则显示纯白背景" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
                                      IsChecked="{Binding Path=Current.ViewShowTransparentGrid, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      VerticalAlignment="Center"/>
                        </Grid>

                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>
                    </StackPanel>

                    <!-- 4. 快捷键设置 -->
                    <StackPanel x:Name="ShortcutPanel" Visibility="Collapsed"  Margin="24,24,44,24">
                        <TextBlock Text="快捷键设置" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <StackPanel Margin="0,0,10,10">

                            <TextBlock Text="视图与导航" FontWeight="Bold" Margin="0,10,0,5"/>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="切换看图/画图模式" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.ToggleMode], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="上一张图片" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.PrevImage], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="下一张图片" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.NextImage], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="全屏显示" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.FullScreen], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="向左旋转" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.RotateLeft], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="向右旋转" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.RotateRight], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="垂直翻转" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.VerticalFlip], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="水平翻转" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[View.HorizontalFlip], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <!-- 第 1.5 组：基础绘图工具 -->
                            <TextBlock Text="基础绘图工具" FontWeight="Bold" Margin="0,15,0,5"/>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="选择工具" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToSelect], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="铅笔" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToPen], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="取色器" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToPick], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="橡皮擦" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToEraser], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>



                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="填充工具" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToFill], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="文字工具" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToText], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="画刷" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToBrush], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="形状" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.SwitchToShape], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <!-- 第二组：高级工具 -->
                            <TextBlock Text="高级工具" FontWeight="Bold" Margin="0,15,0,5"/>

                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="监听剪贴板开关" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.ClipMonitor], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 1. AI 移除背景 -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="AI 移除背景" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.RemoveBg], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 2. AI 绿幕抠图 (新增) -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="色差抠图" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.ChromaKey], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 3. OCR 文字识别 -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="OCR 文字识别" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.OCR], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 4. 屏幕取色器 -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="屏幕取色器" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.ScreenPicker], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 5. 复制 HEX 色值 (新增) -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="复制当前颜色 HEX" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.CopyColorCode], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 6. 智能裁切空白 (新增) -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="智能裁切空白边缘" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.AutoCrop], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 7. 图片加边框 (新增) -->
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="图片加边框" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Tool.AddBorder], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>

                            <!-- 第三组：文件操作 -->
                            <TextBlock Text="其他文件操作" FontWeight="Bold" Margin="0,15,0,5"/>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="打开工作区" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[File.OpenWorkspace], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="粘贴为新标签页" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[File.PasteNewTab], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <!-- 第四组：图像效果 -->
                            <TextBlock Text="图像效果" FontWeight="Bold" Margin="0,15,0,5"/>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="亮度/对比度/曝光" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Effect.Brightness], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="色温/色调/饱和度" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Effect.Temperature], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="黑白" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Effect.Grayscale], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="反色" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Effect.Invert], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="自动色阶" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Effect.AutoLevels], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                            <Grid Margin="0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="调整大小" VerticalAlignment="Center"/>
                                <controls:ShortcutRecorder Grid.Column="1" CurrentItem="{Binding Path=Current.Shortcuts[Effect.Resize], Source={x:Static local:SettingsManager.Instance}}"/>
                            </Grid>
                        </StackPanel>


                        <!-- 恢复默认快捷键按钮 -->
                        <Button Grid.Row="2" 
                                Content="恢复默认快捷键" 
                                HorizontalAlignment="Left" 
                                Foreground="{DynamicResource DangerBrush}" 
                                Background="Transparent" 
                                BorderThickness="0"
                                Click="ResetShortcuts_Click"
                                Cursor="Hand"
                                Margin="0,0,0,5"/>
                    </StackPanel>

                    <!-- 5. 高级 -->
                    <StackPanel x:Name="AdvancedPanel" Visibility="Collapsed" Margin="24,24,44,24">
                        <TextBlock Text="高级" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,20" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <TextBlock Text="渲染与性能" FontWeight="SemiBold" FontSize="16" Margin="0,5,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="220"/>
                                <ColumnDefinition Width="200"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="重采样算法"/>
                                <TextBlock Text="用于图片保存或调整大小时" Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <ComboBox Grid.Column="1" 
                                      Style="{StaticResource FluentComboBoxStyle}"
                                      SelectedValue="{Binding Path=Current.ResamplingMode, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      SelectedValuePath="Tag"
                                      Height="30" VerticalContentAlignment="Center">
                                <ComboBoxItem Content="自动 (Auto)" Tag="Auto"/>
                                <ComboBoxItem Content="双线性 (Bilinear)" Tag="Bilinear"/>
                                <ComboBoxItem Content="Fant (高质量)" Tag="Fant"/>
                                <ComboBoxItem Content="HighQuality" Tag="HighQuality"/>
                            </ComboBox>
                        </Grid>

                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>

                        <TextBlock Text="像素化阈值设置" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,5" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock Text="当缩放倍率超过此值时，画面将从模糊(线性插值)切换为清晰像素(邻近插值)" 
                                   Foreground="{DynamicResource TextTertiaryBrush}" FontSize="12" TextWrapping="Wrap" Margin="0,0,0,15"/>

                        <!-- 看图模式阈值 -->
                        <Grid Margin="0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="70"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="看图模式" VerticalAlignment="Center"/>

                            <Slider Grid.Column="1" Margin="0,0,10,0" Style="{StaticResource Win11HorizontalSliderStyle}"
                                    Minimum="0" Maximum="100" 
                                    SmallChange="1" LargeChange="10"
                                    IsSnapToTickEnabled="False"
                                    VerticalAlignment="Center"
                                    Value="{Binding Path=Current.ViewInterpolationThreshold, Converter={StaticResource NonLinearConverter}, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"/>

                            <!-- 输入框通常需要自定义Style，或者手动设置其颜色，这里假设有全局样式 -->
                            <TextBox Grid.Column="2" 
                                     Text="{Binding Path=Current.ViewInterpolationThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:0}, Source={x:Static local:SettingsManager.Instance}}"
                                     LostFocus="TextBox_LostFocus"
                                     PreviewTextInput="NumberValidationTextBox"
                                     HorizontalContentAlignment="Right" 
                                     VerticalAlignment="Center"
                                     Height="24" Padding="0,2,4,0"/>
                        </Grid>

                        <!-- 画图模式阈值 -->
                        <Grid Margin="0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="70"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Text="画图模式" VerticalAlignment="Center"/>

                            <Slider Grid.Column="1" Margin="0,0,10,0" Style="{StaticResource Win11HorizontalSliderStyle}"
                                    Minimum="0" Maximum="100" 
                                    SmallChange="1" LargeChange="10"
                                    VerticalAlignment="Center"
                                    Value="{Binding Path=Current.PaintInterpolationThreshold, Converter={StaticResource NonLinearConverter}, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"/>

                            <TextBox Grid.Column="2" 
                                     Text="{Binding Path=Current.PaintInterpolationThreshold, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:0}, Source={x:Static local:SettingsManager.Instance}}"
                                     PreviewTextInput="NumberValidationTextBox"
                                     LostFocus="TextBox_LostFocus"
                                     HorizontalContentAlignment="Right" 
                                     VerticalAlignment="Center"
                                     Height="24" Padding="0,2,4,0"/>
                        </Grid>

                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>
                        <TextBlock Text="交互习惯" FontWeight="SemiBold" FontSize="16" Margin="0,15,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <Grid Margin="0,5">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                <TextBlock Text="重置工作区时不弹窗提示"/>
                                <TextBlock Text="清空所有标签页或重置工作区时跳过二次确认弹窗" 
                                           Foreground="{DynamicResource TextTertiaryBrush}" FontSize="11" Margin="0,2,0,0"/>
                            </StackPanel>

                            <CheckBox Grid.Column="2" Style="{StaticResource FluentCheckBoxStyle}" 
                                      IsChecked="{Binding Path=Current.SkipResetConfirmation, Mode=TwoWay, Source={x:Static local:SettingsManager.Instance}}"
                                      VerticalAlignment="Center"/>
                        </Grid>

                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>

                        <TextBlock Text="系统维护" FontWeight="SemiBold" FontSize="16" Margin="0,5,0,10" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- 恢复出厂设置按钮重构：去掉了硬编码的背景色，改为边框风格 -->
                            <Button Content="恢复出厂设置" Width="120" Height="32" 
                                    HorizontalAlignment="Left" Click="FactoryReset_Click"
                                    Background="{DynamicResource ButtonBackgroundBrush}" 
                                    Foreground="{DynamicResource DangerBrush}" 
                                    BorderBrush="{DynamicResource DangerBrush}"
                                    BorderThickness="1"/>

                            <TextBlock Grid.Column="1" Text="清除所有缓存和设置" 
                                       VerticalAlignment="Center" Margin="15,0,0,0" 
                                       Foreground="{DynamicResource TextTertiaryBrush}"/>
                        </Grid>

                    </StackPanel>

                    <!-- 6. 关于页 -->
                    <StackPanel x:Name="AboutPanel" Visibility="Collapsed" Margin="24,24,44,24">
                        <TextBlock Text="关于 TabPaint" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,24" Foreground="{DynamicResource TextPrimaryBrush}"/>

                        <Image x:Name="AppIcon" 
                               Source="pack://application:,,,/Resources/TabPaint.ico" 
                               Width="64" Height="64" 
                               HorizontalAlignment="Left" 
                               RenderOptions.BitmapScalingMode="HighQuality"
                               Margin="0,0,0,16"/>

                        <TextBlock Text="TabPaint" FontSize="18" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        <TextBlock Text="轻量级绘画与看图工具" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="14" Margin="0,4,0,24"/>

                        <StackPanel Orientation="Horizontal" Margin="0,4">
                            <TextBlock Text="开发者: " Foreground="{DynamicResource TextTertiaryBrush}"/>
                            <TextBlock Text="zouxiaofei1" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,4">
                            <TextBlock Text="技术栈: " Foreground="{DynamicResource TextTertiaryBrush}"/>
                            <TextBlock Text=".NET WPF, Win32 API" Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>

                        <!-- 新增：链接区域 -->
                        <Separator Margin="0,15" Background="{DynamicResource BorderLightBrush}"/>

                        <TextBlock Margin="0,6" FontSize="14">
                            <Hyperlink NavigateUri="https://github.com/zouxiaofei1/TabPaint" RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="&#xE943;" FontFamily="Segoe MDL2 Assets"/> <!-- GitHub/Code Icon style -->
                                <Run Text="GitHub 主页"/>
                            </Hyperlink>
                        </TextBlock>

                        <TextBlock Margin="0,6" FontSize="14">
                            <!-- 链接到 Releases 页面 -->
                            <Hyperlink NavigateUri="https://github.com/zouxiaofei1/TabPaint/releases" RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text="&#xE895; " FontFamily="Segoe MDL2 Assets"/> <!-- Sync/Update Icon style -->
                                <Run Text="检查更新"/>
                            </Hyperlink>
                        </TextBlock>

                        <TextBlock Margin="0,6" FontSize="14">
                            <!-- 帮助链接留空，使用特殊协议头标记或在代码中拦截 -->
                            <Hyperlink NavigateUri="cmd://help" RequestNavigate="Hyperlink_RequestNavigate">
                                <Run Text=" " FontFamily="Segoe MDL2 Assets"/> <!-- Help Icon style -->
                                <Run Text="帮助文档"/>
                            </Hyperlink>
                        </TextBlock>

                    </StackPanel>
                </Grid>
            </ScrollViewer>
        </Border>

        <!-- 底部栏 -->
        <!-- Background: #F3F3F3 -> PanelBackgroundBrush -->
        <!-- BorderBrush: #E5E5E5 -> BorderBrush -->
        <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" 
                Background="{DynamicResource PanelBackgroundBrush}" 
                BorderBrush="{DynamicResource BorderBrush}" 
                BorderThickness="0,1,0,0">
            <DockPanel LastChildFill="False" VerticalAlignment="Center" Margin="24,0">
                <!-- Foreground: #888888 -> TextTertiaryBrush -->
                <TextBlock DockPanel.Dock="Left" Text="{Binding ProgramVersion}" 
                           Foreground="{DynamicResource TextTertiaryBrush}" 
                           VerticalAlignment="Center" FontSize="12"/>

                <Button DockPanel.Dock="Right" 
                        Content="确定" 
                        Width="100" Height="32" 
                        Click="OkButton_Click" 
                        IsDefault="True"
                        Style="{StaticResource Win11PrimaryButtonStyle}"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
