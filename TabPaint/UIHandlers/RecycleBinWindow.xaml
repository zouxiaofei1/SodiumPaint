<Window x:Class="TabPaint.UIHandlers.RecycleBinWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TabPaint.UIHandlers"
        mc:Ignorable="d"
        Title="{DynamicResource L_RecycleBin_Title}" Height="400" Width="600"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        ShowInTaskbar="False" Topmost="True" WindowStartupLocation="CenterOwner">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Icons/Icons.xaml"/>
                <ResourceDictionary Source="/Resources/SubWindowStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="32" 
                      ResizeBorderThickness="5" 
                      CornerRadius="10" 
                      GlassFrameThickness="-1"/>
    </WindowChrome.WindowChrome>

    <Border Background="{DynamicResource GlassBackgroundHighBrush}" 
            BorderBrush="{DynamicResource BorderBrush}" 
            BorderThickness="1" 
            CornerRadius="8"
            ClipToBounds="True">
        <Border.Effect>
            <DropShadowEffect BlurRadius="15" ShadowDepth="0" Opacity="0.2"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Grid Grid.Row="0" Background="{DynamicResource ChromeLowBrush}">
                <TextBlock Text="{DynamicResource L_RecycleBin_Title}" 
                           VerticalAlignment="Center" Margin="12,0" 
                           Foreground="{DynamicResource TextPrimaryBrush}" FontWeight="Bold"/>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button Click="CloseButton_Click" Style="{StaticResource OtherCloseButtonStyle}" Width="46" Height="32"/>
                </StackPanel>
            </Grid>

            <!-- Content -->
            <Grid Grid.Row="1" Margin="10">
                <TextBlock x:Name="EmptyHint" Text="{DynamicResource L_RecycleBin_Empty}" 
                           HorizontalAlignment="Center" VerticalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}" Visibility="Collapsed"/>
                
                <ScrollViewer Style="{DynamicResource FluentScrollViewer}" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="RecycleItemsControl">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="5" Width="100" Height="80" CornerRadius="4" 
                                        BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                                        Background="{DynamicResource SystemControlBackgroundAltHighBrush}"
                                        ClipToBounds="True">
                                    <Grid>
                                        <Image Source="{Binding Thumbnail}" Stretch="UniformToFill"/>
                                        
                                        <!-- Days Left (Top Left) -->
                                        <Border HorizontalAlignment="Left" VerticalAlignment="Top" 
                                                Background="#80000000" CornerRadius="0,0,4,0" Padding="4,1">
                                            <TextBlock Text="{Binding DaysLeftString}" Foreground="White" FontSize="10"/>
                                        </Border>

                                        <!-- Restore Button (Top Right) -->
                                        <Button HorizontalAlignment="Right" VerticalAlignment="Top" 
                                                Style="{StaticResource RoundedMenuButtonStyle}" Width="24" Height="24"
                                                Click="Restore_Click" ToolTip="{DynamicResource L_RecycleBin_Restore}">
                                            <Path Data="M13,3V9H7L11,5L13,3M3,13A9,9 0 0,0 12,22C17,22 21,18 21,13H19A7,7 0 0,1 12,20C8.13,20 5,16.87 5,13H3Z" 
                                                  Fill="{DynamicResource IconFillBrush}" Stretch="Uniform" Width="12" Height="12"/>
                                        </Button>

                                        <!-- Delete Button (Bottom Right) -->
                                        <Button HorizontalAlignment="Right" VerticalAlignment="Bottom" 
                                                Style="{StaticResource RoundedMenuButtonStyle}" Width="24" Height="24"
                                                Click="Delete_Click" ToolTip="{DynamicResource L_RecycleBin_DeleteForever}">
                                            <Path Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19V4M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" 
                                                  Fill="#FF4444" Stretch="Uniform" Width="12" Height="12"/>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Grid>
    </Border>
</Window>